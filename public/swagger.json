{
  "openapi": "3.0.0",
  "paths": {
    "/performances": {
      "get": {
        "description": "등록된 모든 공연의 목록을 조회합니다.",
        "operationId": "PerformancesController_getPerformances",
        "parameters": [],
        "responses": {
          "200": {
            "description": "공연 목록 조회 성공",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/CreatePerformanceDto"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Authorization 헤더 필요"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "공연 목록 조회",
        "tags": [
          "performances"
        ]
      },
      "post": {
        "description": "새로운 공연을 등록합니다.",
        "operationId": "PerformancesController_postPerformances",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreatePerformanceDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "공연 등록 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CreatePerformanceDto"
                }
              }
            }
          },
          "400": {
            "description": "잘못된 요청 - 필수 필드 누락 또는 유효성 검사 실패"
          },
          "401": {
            "description": "Authorization 헤더 필요"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "공연 등록",
        "tags": [
          "performances"
        ]
      }
    },
    "/performances/{performanceId}": {
      "get": {
        "description": "특정 공연의 상세 정보를 조회합니다.",
        "operationId": "PerformancesController_getPerformance",
        "parameters": [
          {
            "name": "performanceId",
            "required": true,
            "in": "path",
            "description": "공연 ID",
            "schema": {
              "example": 1,
              "type": "number"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "공연 상세 조회 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CreatePerformanceDto"
                }
              }
            }
          },
          "401": {
            "description": "Authorization 헤더 필요"
          },
          "404": {
            "description": "공연을 찾을 수 없습니다."
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "공연 상세 조회",
        "tags": [
          "performances"
        ]
      },
      "patch": {
        "description": "기존 공연 정보를 수정합니다.",
        "operationId": "PerformancesController_patchPerformance",
        "parameters": [
          {
            "name": "performanceId",
            "required": true,
            "in": "path",
            "description": "공연 ID",
            "schema": {
              "example": 1,
              "type": "number"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdatePerformanceDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "공연 수정 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UpdatePerformanceDto"
                }
              }
            }
          },
          "401": {
            "description": "Authorization 헤더 필요"
          },
          "404": {
            "description": "공연을 찾을 수 없습니다."
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "공연 수정",
        "tags": [
          "performances"
        ]
      },
      "delete": {
        "description": "공연을 삭제합니다.",
        "operationId": "PerformancesController_deletePerformance",
        "parameters": [
          {
            "name": "performanceId",
            "required": true,
            "in": "path",
            "description": "공연 ID",
            "schema": {
              "example": 1,
              "type": "number"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "공연 삭제 성공",
            "content": {
              "application/json": {
                "schema": {
                  "example": {
                    "message": "해당 1 공연 정보가 삭제되었습니다."
                  }
                }
              }
            }
          },
          "401": {
            "description": "Authorization 헤더 필요"
          },
          "404": {
            "description": "공연을 찾을 수 없습니다."
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "공연 삭제",
        "tags": [
          "performances"
        ]
      }
    },
    "/reservations/{performanceId}": {
      "post": {
        "description": "공연 좌석을 임시로 예약합니다. 10분 내 확정하지 않으면 자동 취소됩니다.",
        "operationId": "ReservationsController_postReservation",
        "parameters": [
          {
            "name": "x-user-id",
            "in": "header",
            "description": "사용자 ID (API Gateway에서 자동 추가)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "performanceId",
            "required": true,
            "in": "path",
            "description": "공연 ID",
            "schema": {
              "example": 1
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "seatCount": {
                    "type": "number",
                    "description": "예약할 좌석 수 (1-10)",
                    "example": 2
                  }
                },
                "required": [
                  "seatCount"
                ]
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "좌석 임시 예약 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReservationResponseDto"
                }
              }
            }
          },
          "400": {
            "description": "예약 실패 - 예약 좌석 수는 1 이상이어야 합니다. 또는 한 번에 최대 10개까지만 예약 가능합니다. 또는 예약 좌석 수는 정수여야 합니다. 또는 요청하신 좌석이 부족합니다."
          },
          "401": {
            "description": "Authorization 헤더 필요"
          },
          "404": {
            "description": "공연을 찾을 수 없습니다."
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "좌석 임시 예약",
        "tags": [
          "reservations"
        ]
      }
    },
    "/reservations/{performanceId}/{reservationId}/confirm": {
      "patch": {
        "description": "임시 예약을 확정합니다. (결제 완료 후)",
        "operationId": "ReservationsController_patchConfirmReservation",
        "parameters": [
          {
            "name": "x-user-id",
            "in": "header",
            "description": "사용자 ID (API Gateway에서 자동 추가)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "performanceId",
            "required": true,
            "in": "path",
            "description": "공연 ID",
            "schema": {
              "example": 1
            }
          },
          {
            "name": "reservationId",
            "required": true,
            "in": "path",
            "description": "예약 ID",
            "schema": {
              "example": 1
            }
          }
        ],
        "responses": {
          "200": {
            "description": "예약 확정 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReservationResponseDto"
                }
              }
            }
          },
          "400": {
            "description": "예약 확정 실패 - 이미 확정된 예약이거나, 만료되었거나, 취소된 예약입니다."
          },
          "401": {
            "description": "Authorization 헤더 필요"
          },
          "403": {
            "description": "자신의 예약만 확정할 수 있습니다."
          },
          "404": {
            "description": "예약 정보를 찾을 수 없습니다."
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "예약 확정",
        "tags": [
          "reservations"
        ]
      }
    },
    "/reservations/{performanceId}/{reservationId}/cancel": {
      "patch": {
        "description": "결제 전 임시 예약을 취소합니다. 좌석이 복구됩니다.",
        "operationId": "ReservationsController_patchCancelReservation",
        "parameters": [
          {
            "name": "x-user-id",
            "in": "header",
            "description": "사용자 ID (API Gateway에서 자동 추가)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "performanceId",
            "required": true,
            "in": "path",
            "description": "공연 ID",
            "schema": {
              "example": 1
            }
          },
          {
            "name": "reservationId",
            "required": true,
            "in": "path",
            "description": "예약 ID",
            "schema": {
              "example": 1
            }
          }
        ],
        "responses": {
          "200": {
            "description": "예약 취소 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReservationResponseDto"
                }
              }
            }
          },
          "400": {
            "description": "예약 취소 실패 - 이미 확정된 예약은 해제할 수 없습니다. 또는 이미 취소되었거나 만료된 예약입니다."
          },
          "401": {
            "description": "Authorization 헤더 필요"
          },
          "403": {
            "description": "자신의 예약만 취소할 수 있습니다."
          },
          "404": {
            "description": "예약 정보를 찾을 수 없습니다."
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "예약 취소",
        "tags": [
          "reservations"
        ]
      }
    },
    "/reservations/{performanceId}/{reservationId}/refund": {
      "patch": {
        "description": "확정된 예약을 취소하고 환불합니다. 좌석이 복구됩니다.",
        "operationId": "ReservationsController_patchRefundReservation",
        "parameters": [
          {
            "name": "x-user-id",
            "in": "header",
            "description": "사용자 ID (API Gateway에서 자동 추가)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "performanceId",
            "required": true,
            "in": "path",
            "description": "공연 ID",
            "schema": {
              "example": 1
            }
          },
          {
            "name": "reservationId",
            "required": true,
            "in": "path",
            "description": "예약 ID",
            "schema": {
              "example": 1
            }
          }
        ],
        "responses": {
          "200": {
            "description": "환불 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReservationResponseDto"
                }
              }
            }
          },
          "400": {
            "description": "환불 실패 - 확정된 예약만 환불 가능합니다."
          },
          "401": {
            "description": "Authorization 헤더 필요"
          },
          "403": {
            "description": "자신의 예약만 환불할 수 있습니다."
          },
          "404": {
            "description": "예약 정보를 찾을 수 없습니다."
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "환불",
        "tags": [
          "reservations"
        ]
      }
    }
  },
  "info": {
    "title": "Performance Service API",
    "description": "공연 예약 서비스 REST API\n\n공연 정보 관리 및 좌석 예약 기능을 제공합니다.\n- 공연 CRUD 기능\n- 좌석 임시 예약\n- 예약 확정/취소/환불",
    "version": "1.0.0",
    "contact": {}
  },
  "tags": [
    {
      "name": "performances",
      "description": "공연 관리 API"
    },
    {
      "name": "reservations",
      "description": "예약 관리 API"
    }
  ],
  "servers": [
    {
      "url": "https://performance-service.vercel.app",
      "description": "Production"
    },
    {
      "url": "http://localhost:3000",
      "description": "Development"
    }
  ],
  "components": {
    "securitySchemes": {
      "bearer": {
        "scheme": "bearer",
        "bearerFormat": "JWT",
        "type": "http"
      }
    },
    "schemas": {
      "CreatePerformanceDto": {
        "type": "object",
        "properties": {
          "title": {
            "type": "string",
            "description": "공연 제목",
            "example": "오페라의 유령"
          },
          "description": {
            "type": "string",
            "description": "공연 설명",
            "example": "브로드웨이의 전설적인 뮤지컬 오페라의 유령"
          },
          "category": {
            "type": "string",
            "description": "공연 카테고리",
            "enum": [
              "THEATER",
              "MUSICAL",
              "CONCERT",
              "EXHIBITION",
              "MOVIE"
            ],
            "example": "MUSICAL"
          },
          "venue": {
            "type": "string",
            "description": "공연 장소",
            "example": "샤롯데씨어터"
          },
          "imageUrl": {
            "type": "string",
            "description": "공연 포스터 이미지 URL",
            "example": "https://example.com/poster.jpg"
          },
          "price": {
            "type": "number",
            "description": "티켓 가격 (원)",
            "example": 150000,
            "minimum": 1
          },
          "totalSeats": {
            "type": "number",
            "description": "전체 좌석 수",
            "example": 500,
            "minimum": 1
          },
          "availableSeats": {
            "type": "number",
            "description": "예약 가능한 좌석 수",
            "example": 500
          }
        },
        "required": [
          "title",
          "description",
          "category",
          "venue",
          "price",
          "totalSeats",
          "availableSeats"
        ]
      },
      "UpdatePerformanceDto": {
        "type": "object",
        "properties": {
          "title": {
            "type": "string",
            "description": "공연 제목",
            "example": "오페라의 유령"
          },
          "description": {
            "type": "string",
            "description": "공연 설명",
            "example": "브로드웨이의 전설적인 뮤지컬 오페라의 유령"
          },
          "category": {
            "type": "string",
            "description": "공연 카테고리",
            "enum": [
              "THEATER",
              "MUSICAL",
              "CONCERT",
              "EXHIBITION",
              "MOVIE"
            ],
            "example": "MUSICAL"
          },
          "venue": {
            "type": "string",
            "description": "공연 장소",
            "example": "샤롯데씨어터"
          },
          "imageUrl": {
            "type": "string",
            "description": "공연 포스터 이미지 URL",
            "example": "https://example.com/poster.jpg"
          },
          "price": {
            "type": "number",
            "description": "티켓 가격 (원)",
            "example": 150000,
            "minimum": 1
          },
          "totalSeats": {
            "type": "number",
            "description": "전체 좌석 수",
            "example": 500,
            "minimum": 1
          },
          "availableSeats": {
            "type": "number",
            "description": "예약 가능한 좌석 수",
            "example": 500
          }
        }
      },
      "ReservationResponseDto": {
        "type": "object",
        "properties": {
          "performanceId": {
            "type": "number",
            "description": "공연 ID",
            "example": 1
          },
          "reservationId": {
            "type": "number",
            "description": "예약 ID",
            "example": 1
          },
          "title": {
            "type": "string",
            "description": "공연 제목",
            "example": "오페라의 유령"
          },
          "price": {
            "type": "number",
            "description": "티켓 가격",
            "example": 150000
          },
          "availableSeats": {
            "type": "number",
            "description": "예약 가능한 좌석 수",
            "example": 498
          },
          "refundedSeats": {
            "type": "number",
            "description": "환불된 좌석 수",
            "example": 2
          },
          "status": {
            "type": "string",
            "description": "예약 상태",
            "enum": [
              "PENDING",
              "CONFIRMED",
              "CANCELLED",
              "EXPIRED"
            ],
            "example": "PENDING"
          },
          "message": {
            "type": "string",
            "description": "응답 메시지",
            "example": "임시 예약이 완료되었습니다."
          }
        },
        "required": [
          "performanceId",
          "reservationId",
          "status",
          "message"
        ]
      }
    }
  }
}